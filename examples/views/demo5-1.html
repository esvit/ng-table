<div class="page-header">
    <h1>Saving params in url</h1>
</div>

<script data-run-script>
    window.DemoCtrl = function($scope, $location, $filter, ngTableParams) {
        var data = [{name: "Moroni", age: 50},
            {name: "Tiancum", age: 43},
            {name: "Jacob", age: 27},
            {name: "Nephi", age: 29},
            {name: "Enos", age: 34},
            {name: "Tiancum", age: 30},
            {name: "Jacob", age: 28},
            {name: "Nephi", age: 30},
            {name: "Enos", age: 33},
            {name: "Tiancum", age: 34},
            {name: "Jacob", age: 28},
            {name: "Nephi", age: 31},
            {name: "Enos", age: 32},
            {name: "Tiancum", age: 50},
            {name: "Jacob", age: 27},
            {name: "Nephi", age: 29},
            {name: "Enos", age: 31}];

        $scope.tableParams = new ngTableParams(
                // merge default params with url
                angular.extend({
                            page: 1,            // show first page
                            count: 10,          // count per page
                            sorting: ['+name']  // initial sorting
                        },
                        $location.search()), {
                    total: data.length, // length of data
                    getData: function($defer, params) {
                        $location.search(params.url()); // put params in url

                        // use build-in angular filter
                        var orderedData = params.sorting ?
                                $filter('orderBy')(data, params.sorting()) :
                                data;

                        $defer.resolve(orderedData.slice((params.page() - 1) * params.count(), params.page() * params.count()));
                    }
                }
        );
    }
</script>

<div ng-controller="DemoCtrl">

    <table ng-table="tableParams" class="table">
        <tr ng-repeat="user in $data">
            <td data-title="'Name'" sortable="'name'">
                {{user.name}}
            </td>
            <td data-title="'Age'" sortable="'age'">
                {{user.age}}
            </td>
        </tr>
    </table>

</div>
